<launch>
  <!-- YAMLファイルを読み込む -->
  <arg name="config_file" default="/home/sskr3/acm_ws/settings.yaml" />

  <!-- パラメータを読み込み -->
  <rosparam file="$(arg config_file)" command="load" />

  <!-- arduino -->
  <node pkg="serial_to_mag" type="serial_to_mag_node" name="serial_to_mag_node" output="screen">
    <param name="port" value="$(param serial_to_mag_node/port)" />
    <param name="baudrate" value="$(param serial_to_mag_node/baudrate)" />
  </node>

  <!-- dynamixel -->
  <node pkg="dynamixel_control" type="multi_pos_ctrl_node" name="multi_pos_ctrl_node" output="screen">
    <param name="device_name"  value="$(param multi_pos_ctrl_node/device_name)" />
    <param name="baud_rate"    value="$(param multi_pos_ctrl_node/baud_rate)" />
    <param name="motor_count"  value="$(param multi_pos_ctrl_node/motor_count)" />
    <param name="freq"         value="$(param multi_pos_ctrl_node/freq)" />
    <remap from="/goal_positions"      to="$(param multi_pos_ctrl_node/goal_topic)" />
    <remap from="/present_positions"   to="$(param multi_pos_ctrl_node/pos_topic)" />
    <remap from="/present_currents"    to="$(param multi_pos_ctrl_node/cur_topic)" />
  </node>

  <!-- bilateral_test -->
  <node pkg="bilateral_test" type="mag_tension_converter" name="mag_tension_converter" output="screen">
    <rosparam file="$(find bilateral_test)/config/csv_params.yaml" command="load" />
  </node>

  <!-- PD制御ノード -->
  <node name="pd_control_node" pkg="feedback_control" type="pd_control_node" output="screen">
    <param name="Kp" value="$(param pd_control_node/Kp)" />
    <param name="Kd" value="$(param pd_control_node/Kd)" />
    <param name="publish_index" value="$(param pd_control_node/publish_index)" />
    <param name="motor_inverse" value="$(param pd_control_node/motor_inverse)" />
  </node>
</launch>